<!DOCTYPE html>
<html>
    <head>
        <title><%= title %></title>
        <meta charset = 'utf-8'>
        <link rel = 'stylesheet' href='/stylesheets/style.css'/>
        <script src = "/javascripts/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
        <style>
            body{margin:0px; padding:0px;background-color:white;}
      
            .header{background-color:black; position:fixed; width:100%; top:0; left:0; z-index:1;}
            ul.nav{float:right; list-style:none; width:45%; height:20px;}
            ul.nav li{float:left; color:white;}
            ul.nav a{line-height:20px; color:#ffffff; padding:0 15px; text-decoration:none;}
      
            .bottom{line-height:50px; height:50px; width:100%; background-repeat:repeat; background-attachment: scroll; background-position:0% 0%; background-color:black;position:fixed; bottom:0pt; left:0pt;}
            .button{background-color:white; border:0px; color:black;text-decoration:none;}
            .button:hover{font-weight:bold; background-color:lightgray;}
            .log-but{border:1px solid black; width:95px; height:50px;}
            .log-but:hover{font-weight:bold;}
            a{text-decoration:none; color:black;}
          </style>
    </head>
    <body>
        <div class="header">
            <div>
              <ul class="nav">
                <li style="float:right; margin-right:20px;"><a href='/'>메인페이지</a></li>
              </ul>
            </div>
        </div>
        <div style="margin-top:90px; margin-left:203px; width:130px; font-size:30px; margin-bottom:20px;">
            상품 상세
        </div>
        <!-- id = "bookDetailRead" form에 추가? -->
        <form action = "/book/detail/update" method = "get">
            <table width = "1000px" border = "3" style="margin:0 auto; border-collapse:collapse;">
                <input type="hidden" name="book_num" value = "<%=row.book_num %>"/>
                <tr>
                    <!-- <td rowspan = "6">표지</td> -->
                    <td rowspan = "4" style="width:200px; height:300px;"><img src="/images/<%= row.image %>" alt="" width="170px" height="280px"></td>
                    <td colspan="4" style="font-size:25px;"><strong><%=row.book_title %></strong></td>
                </tr>
                <tr>
                    <td colspan="4" style="font-size:20px;"><%=row.book_genre %> </td>
                </tr>
                <tr>
                    <td style="width:100px; text-align:center;">출판사</td>
                    <td><%=row.publisher %></td>
                    <td style="width:100px; text-align:center;">저자</td>
                    <td><%=row.author %></td>
                </tr>
                <tr>
                    <td colspan = "5"><%=row.book_price %></td>
                    <!-- <td rowspan = "2">
                        <input type='button'onclick='count("plus")'value='+'/>
                        <input type='button'onclick='count("minus")'value='-'/>
                        <div id='quantity'>0</div>
                    </td> -->
                    <!-- oneclick 추가 -->
                </tr>
                <tr>
                    <td colspan = "5" style="height:100px;"><%=row.book_content %></td>
                </tr>
            </table>
            <div style="margin:0 auto; margin-top:10px; margin-left:203px; text-align:left; float:left;">
                <button type = "submit">수정</button>
            </div>
        </form>
        <div style="width:100px; margin-left:393px; margin-top:10px; float:left; margin-left:10px;">
            <form action="/book/detail/delete" method="post">
                <input type="hidden" name="book_num" value="<%= row.book_num %>"/>
                <button type="submit">글 삭제</button>
            </form>
        </div>
        <div style="width:80px; margin-left:1121px; float:left; margin-top:-25px; text-align:right;">
            <form action = "/orders/cart" method = "post">
                <input type = "button" id = "장바구니" name = "장바구니" value = "장바구니" onclick="handleclick('<%= JSON.stringify(row) %>')">
            </form>
        </div>
        <div style="width:1000px; margin:0 auto; margin-top:80px; height:400px;">
            <hr style="width:1000px; margin-bottom:30px;">
            <form action = "/book/detail/review" method = "get">
                <input type="hidden" name="book_num" value = "<%=row.book_num %>"/>
                <!-- 리뷰/평점 -->
                <strong style="font-size:20px;">리뷰 / 평점</strong>
                <div style="float:right;">
                    <button type = "submit">리뷰작성</button>
                </div>
    
    
                <br><br>
    
                <div class="starAvg">
                    <p>**평균별점, 이미지 표시**</p>
                </div>
    
                <br><br>
    
                <div class="reviewForm">
                    <div class="reviewHead">
                        <ul style="list-style-type:none; padding-left:0px;">
                            <li style="float:left; margin-right:30px;">**star표시**</li>
                            <li style="float:left; margin-right:30px;">**id표시**</li>
                            <li style="float:left; margin-right:30px;">**date표시**</li>
                        </ul>
                    </div>
                    
                    <br>
                    <div class="reivewontent">
                        <p><%=row.review_content%></p>
                    </div>
                </div>
            </form>
        </div>
        
        <script>
            //버튼을 클릭해서 구매 수량을 +/-하는 함수
            //구매자 페이지에서만 나타나게 해야함?
            function count(type)  {
                // 결과를 표시할 element
                const resultElement = document.getElementById('quantity');
                
                // 현재 화면에 표시된 값
                let number = resultElement.innerText;
                
                // 더하기/빼기
                if(type === 'plus'){
                number = parseInt(number) + 1;
                }else if(type === 'minus'){
                number = parseInt(number) - 1;
                }//수량이 음수면 경고 메세지 출력하기
                // if(number < 0){
                //     alert('수량은 음수가 될 수 없습니다.');
                //     //근데 화면에는 여전히 -1이 출력됨!
                // }
                
                // 결과 출력
                resultElement.innerText = number;
            }
            const handleInsert = (row) => {
                axios.post('http://localhost:3000/orders/buy',{params: row})
                .then(() => location.href = '/orders/buy').then(() => console.log('fdsfasd'));
                
            }
            // const handleclick = (item) => {
            //     axios
            //     .post('http://localhost:3000/orders/cart', {params: {...item}})
            //     .then(res => console.log(item));
            // };
            const handleclick = (row) => {
                axios.post('http://localhost:3000/orders/cart',{params: row})
                .then(() => location.href = '/orders/cart').then(() => console.log('fdsfasd'));
            };
        </script>
        <div style="height:200px;"></div>
        <div class="bottom" style="color:white;">
            <div style="float:left; margin-left:25px;"><strong>CONTACT</strong>&emsp;031-909-9999</div>
            <div style="float:right; margin-right:30px;"><strong>주소</strong>&emsp;서울특별시 노원구 월계3동 광운대학교</div>
        </div>
    </body>
</html>